FireLight.fx v0.0.3

炎っぽくゆらゆら揺れる点光源エフェクトです。


・動作環境
SM3.0+VTF対応グラフィックボードが必須になります。
またMMEv0.33以降でないと正しく動作しません。


・基本的な使用方法
(1)FireLight.xをMMDにロードしてください。MMMではFireLight.fxをロード
(2)必要に応じてFireLight.fxとFL_Object.fxsubの先頭パラメータを変更してください。
   (同名パラメータは同じ値に設定してください)
(3)MMDでFireLight.xのアクセサリパラメータから以下の変更が可能です。
  MME/MMM共通
   XYZ：光源位置変更(ボーンにアサインしてもOK)
   Si：ライトの明るさ調整
  MMEのみ
   Rx：ライトの位置の揺らぎ振幅( -1.0 〜 +1.0 ぐらいで調整)
   Ry：ライトの位置の揺らぎ周波数( -1.0 〜 +1.0 ぐらいで調整)
   Rz：ライトの明るさ揺らぎ周波数( -1.0 〜 +1.0 ぐらいで調整)
   その他のパラメータはFireLight.fxの先頭パラメータより変更
  MMMではFireLight.fxのエフェクトプロパティに追加したUIコントロールよりパラメータ変更が可能です。


・セルフシャドウ使用時の注意点
(1)セルフシャドウONにした場合はロード･更新に時間がかかる場合があります。
(2)面積が大きいポリゴンを含むモデルではセルフシャドウが正常に描画されない場合があります
   床面でセルフシャドウが先細って消えてしまう様な場合はFloorAssist.xをMMDにロードすると直ります。


・複数光源の使用方法
このエフェクトは同じ名前のxファイルを複数ロードすると正常に動作しなくなるので注意してください。
複数の光源を用いたい場合はファイル名に連番の付いた別xファイルをロードする必要があります。
デフォルトでは1〜4を用意、1は連番なしで2〜4はLight2〜Light4フォルダに同梱してあります。
新たに増やしたい場合は以下の方法で作成してください。例として｢5｣について、
(1)新たにフォルダ｢Light5｣を作成してそこにFireLight.fx,FL_Object.fxsub,FL_ShadowMap.fxsub,FL_ShadowMapFA.fxsub,FireLight.xをコピー
(2)FireLight5.fx,FL_Object5.fxsub,FL_ShadowMap5.fxsub,FL_ShadowMapFA5.fxsub,FireLight5.xにリネーム
(3)FireLight5.fx,FL_Object5.fxsub,FL_ShadowMap5.fxsub,FL_ShadowMapFA5.fxsubの先頭パラメータLightIDを 5 に変更


・Lat式モデルの対応について
このエフェクトではPMD・PMXモデルについてもライティング処理としてフォンシェードを採用しているため
Lat式モデルに適用するとフェイス部がとんでもない描画になってしまいます(Lat式モデルのフェイス部は特殊なデータ構造で
MMDのトーンシェードにしか対応していないため)。
そこで特別措置としてLat式モデル専用エフェクトを適用することでこの問題を回避出来ます。
   使用方法
   (1)FL_ObjectLat.fxの先頭パラメータで、Lat式モデルのフェイス材質番号リストを記述します。
      デフォルトでは Lat式ミクVer2.31_Normal.pmd に合わせているので使用モデルによって材質を調べて書き換える必要があります。
   (2)FL_ObjectLat.fxをオフスクリーンタブ｢FireLightingRT｣にあるLat式モデルを選択して適用します。
   (3)複数光源を使用する場合は上述の｢複数光源の使用方法｣と同様の方法でFL_ObjectLat.fxを書き換える必要があります。


・更新履歴
v0.0.3  2014/05/07   ライティング処理をHgPointLightベースに変更
                     Lat式モデルの対応エフェクト追加
v0.0.2  2013/06/28   MMEシェーダを新しいバージョン(v0.33以降)仕様にした(PMXの材質モーフ､サブTex等に対応)
                     MikuMikuMovingの対応
v0.0.1  2012/09/18   初回版公開


・免責事項
ご利用・改変・二次配布は自由にやっていただいてかまいません。連絡も不要です。
ただしこれらの行為は全て自己責任でやってください。
このプログラム使用により、いかなる損害が生じた場合でも当方は一切の責任を負いません。


by 針金P
Twitter : @HariganeP


