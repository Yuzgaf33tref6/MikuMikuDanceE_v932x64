BoardSelfBurning.fx v0.0.5

モデルの形状に合わせてメラメラ炎を出すエフェクト。
粒子系のエフェクトではなく、1枚板ポリのビルボードとテクスチャアニメーションを組み合わせて
実現しています。炎アニメはFuria氏の｢2Dな炎エフェクトサンプル｣を参考に作成しました。


・動作環境
SM3.0対応グラフィックボードが必須になります。
またMMEv0.24以降でないと正しく動作しません。


・基本的な使用方法
(1)BoardSelfBurning.xをMMDにロードしてください。
(2)描画順序はできるだけ後の方にしてください．
(3)BoardSelfBurning.xをエフェクト適用するモデルの中心ボーン(通常はセンターボーンでOK)に付ける。
   適用モデルがアクセサリの場合はBoardSelfBurning.xをアクセサリの近くに移動させる。
(4)MMEの設定で｢MMEffect｣→｢エフェクト割当｣の｢BSB_ObjectRT｣タブより適用モデルを選択してBSB_Object.fxを割り当て、
   ｢BSB_MaskRT｣タブより適用モデルを選択して非表示にする。これでモデルが燃えます。
(5)必要に応じてBoardSelfBurning.fxの先頭パラメータを変更してください。
(6)BoardSelfBurning.xのアクセサリパラメータで、それぞれ以下の制御が可能です。
   XYZ：位置合わせ
   Ry：モデル形状のぼかし度(-1.0 〜 +1.0 程度で調整、＋値にすると炎の外縁がマイルドになり、−値にするとシャープになります)
   Rz：モデル形状のはみ出し度(炎の外縁がモデルからどれだけ離れているか、ここを大きくすると炎自体も大きくなります)
   Si：ボードの描画範囲調整、モデルの動きが速く大きくて炎が見切れてしまう場合は、ここを大きくすると
       収まる様になります(その分、炎描画の解像度は下がりますが)。
   Tr：炎描画の透過度
   影：on/offで炎の消化と着火をスムーズに行えます(｢表示｣→｢セルフシャドウ表示｣off、また｢シャドウ設定｣でシャドウOFFの時は使えません)。
(7)｢BSB_MaskRT｣タブより適用モデルを選択してBSB_MaskModel.fxを割り当てると、モデル部分が型抜きされオーラっぽくなります。


・背景移動演出時の利用方法ついて
オブジェクトの動きを表現する場合、直接オブジェクトを動かす以外に、背景の方を移動させてオブジェクトが
動いているように見せるような演出がよく使われます。
同梱のBackgroundControl.xを用いるとオブジェクトを動かさなくても、背景の動きに連動して炎の挙動が変化します。
(1)BackgroundControl.xをMMDにロードしてください。アクセ自体は表示されません。
(2)BackgroundControl.xを背景モデルを移動させるボーンに共に付けてください。
(3)このボーンを動かすと炎の動きはボーンの位置・角度を基準にした座標系に切り替わり、
   オブジェクトとの相対的な位置関係でオブジェクトの移動量を計算して炎の挙動が変化します。


・使用時の注意点
(1)仕様上、真上・真下からのカメラアングルには弱いです。
(2)地面との接地点で炎が不自然に切れてしまいます(ボードが地面の下に潜ってしまうため)。
   対応策としてはBSB_MaskRTより地面アクセ(出来ればサブセット展開して床面材質のみ)を非表示にすれば切れなくなりますが、
   地面アクセと炎の前後関係が正しく表示されなくなることもあり、ケースバイケースの対応が必要になります。
(3)FPSの違いで炎の状態が変化してしまいます。出力FPSを先に設定してからBoardSelfBurning.fxの先頭パラメータ調整した方が良いです。


・更新履歴
v0.0.5  2013/6/23   BackgroundControl.x追加、背景を移動させてオブジェクトが動いているように
                    見せる演出でも使えるようにした
                    MikuMikuMoving版の追加
v0.0.4  2013/2/12   マスク処理改良時のバグ修正
v0.0.3  2013/2/11   ボードのマスク処理方法を改良、型抜きが綺麗に出来るようにした
v0.0.2  2012/12/27  テクスチャアニメーションのフレーム更新方法を修正
                    パースペクティブoff時でも正しく座標変換出来るようにした
                    型抜き方法の説明追加
v0.0.1  2012/9/18   初回版公開


・免責事項
ご利用・改変・二次配布は自由にやっていただいてかまいません。連絡も不要です。
ただしこれらの行為は全て自己責任でやってください。
このプログラム使用により、いかなる損害が生じた場合でも当方は一切の責任を負いません。


by 針金P
Twitter : @HariganeP


