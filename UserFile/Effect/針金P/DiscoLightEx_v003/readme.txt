DiscoLightEx.fx v0.0.3

舞力介入P氏のDiscoLightingの拡張版です。
以下の点を改良しました。
①オフスクリーンバッファによる点光源ライティング処理(多分扱いやすくなった)。
②セルフシャドウの対応
③CubeMapテクスチャをやめて、通常の2Dテクスチャを使用(テクスチャ差し替えが簡単に)。
④ボーン・表情による操作、複数テクスチャの切り替えが可能。
⑤MikuMikuMovingの対応


・動作環境
SM3.0対応グラフィックボードが必須になります。
またMMEv0.33以降でないと正しく動作しません。


・基本的な使用方法
(1)DiscoLightEx.pmxをMMDにロードしてください。
   MMMではDiscoLightEx.fxとDiscoLightEx.pmxを両方ロード、描画順を必ずDiscoLightEx.pmx→DiscoLightEx.fxとなるようにして下さい。
(2)必要に応じてDiscoLightEx.fx,DLEX_Object.fxsubの先頭パラメータを変更してください。
   (同名パラメータは同じ値に設定してください)
(3)DiscoLightEx.pmxのボーン・表情スライダのそれぞれの項目で以下の制御が可能です。
   [ボーン]
     光源位置：ボーン座標がライトの光源位置になります。
   [表情スライダ]
     目  ：+X回転,+Y回転,+Z回転 → 光源の正回転
     ﾘｯﾌﾟ：-X回転,-Y回転,-Z回転 → 光源の逆回転
     まゆ：ライト種類 → ライトテクスチャの切り替え(最大6種類まで)
     その他：発光強度 → ライトの明るさ調整(最大発光強度はDiscoLightObject.fxの先頭パラメータで指定)
             影ぼかし,影濃度 → セルフシャドウの調整


・ライトボール使用方法(ライティング処理自体は無くても動きます)
(1)DiscoLightBall.xをMMD/MMMにロードしてください。
   MMMではDiscoLightBall.fxもロードしてメインのエフェクト割り当てでDiscoLightBall.xに適用します。
(2)DiscoLightBall.xのSiでボールのサイズ調整ができます。
   MMMではDiscoLightBall.fxとDiscoLightBall.xを個別に同じサイズに設定する必要があります。
(3)DiscoLightBall.fxの先頭パラメータはDLEX_Object.fxsubと同じ値に設定してください。
(4)AutoLuminous使用時にはDiscoLightBall.fxをAL_EmitterRTのDiscoLightBall.xに適用することで発光します。


・セルフシャドウ使用時の注意点
(1)先頭パラメータがセルフシャドウONの状態でDiscoLightEx.pmxを複数ロードすると正常に動作しなくなります。
(2)セルフシャドウONにした場合はロード･更新に時間がかかる場合があります。
(3)面積が大きいポリゴンを含むモデルではセルフシャドウが正常に描画されない場合があります
   床面でセルフシャドウが先細って消えてしまう様な場合はFloorAssist.xをMMDにロードすると直ります。


・Lat式モデルの対応について
このエフェクトではPMD・PMXモデルについてもライティング処理としてフォンシェードを採用しているため
Lat式モデルに適用するとフェイス部がとんでもない描画になってしまいます(Lat式モデルのフェイス部は特殊なデータ構造で
MMDのトーンシェードにしか対応していないため)。
そこで特別措置としてLat式モデル専用エフェクトを適用することでこの問題を回避出来ます。
   使用方法
   (1)DLEX_ObjectLat.fxの先頭パラメータで、Lat式モデルのフェイス材質番号リストを記述します。
      デフォルトでは Lat式ミクVer2.31_Normal.pmd に合わせているので使用モデルによって材質を調べて書き換える必要があります。
   (2)DLEX_ObjectLat.fxをオフスクリーンタブ｢DiscoLightingRT｣にあるLat式モデルを選択して適用します。



・更新履歴
v0.0.3  2014/05/07   ライティング処理をHgPointLightベースに変更
                     Lat式モデルの対応エフェクト追加
v0.0.2  2013/06/27   MMEシェーダを新しいバージョン(v0.33以降)仕様にした(PMXの材質モーフ､サブTex等に対応)
                     MikuMikuMovingの対応
v0.0.1  2012/09/18   初回版公開


・免責事項
ご利用・改変・二次配布は自由にやっていただいてかまいません。連絡も不要です。
ただしこれらの行為は全て自己責任でやってください。
このプログラム使用により、いかなる損害が生じた場合でも当方は一切の責任を負いません。


by 針金P
Twitter : @HariganeP


