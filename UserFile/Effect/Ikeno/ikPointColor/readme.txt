
ikPointColor


■ 概要

	モノクロ+ポイントカラーにするエフェクト。

	事前に、パレットテクスチャに8つのグラデーションを設定します。
	モデル・素材単位でパレットを指定します。
	パレットと元画像の明暗から、どの色で塗りつぶすか決定されます。


■ 使用方法

	1.MMDのアクセサリに、"ikPointColor.x"を追加する。
	2.アクセサリの表示順序を適宜上下させてください。
		他のポストエフェクトとの兼ね合いで、表示順序によって効果が変わる場合があります。

	3.pallet34.png の内容を適当な画像編集ツールで書き換えます。
		※ MMD動作中にパレットを書き換えても、更新が反映されない場合があります。

	4.MMEのタブにある、「PointColorMapRT」で、モデル・素材ごとのパレットを指定します。
		ikColorMark0.fx〜ikColorMark7.fxで、パレットの0〜7に置き換えます。
		ikColorMarkSelect.fx は自動判定で置き換えを行います（精度は悪いです）。
		ikColorMarkSelect2.fx は決められた2色に置き換えます。



■ ファイル

	ikPointColor.x
	ikPointColor.fx
		エフェクト本体


	ikColorMark0.fx〜ikColorMark7.fx
		MMEの「PointColorMapRT」タブに設定する。
		モデル/素材に各数値のパレット番号を割り当てる。
		大抵はこれだけでパレット指定が可能です。

		数字だと判りにくいので、ファイルをコピーして "mark_髪.fx" というように、
		判りやすい名前に変えてもいいでしょう。


	ikColorMarkSelect.fx
		MMEの「PointColorMapRT」タブに設定する。
		一つのモデル・素材内で、テクスチャの色に応じてパレット番号を変えたい場合に使用します。

		例1：目の素材のうち、黒目の部分だけ指定のパレットにしたい。
		例2：服の飾りの部分だけ指定のパレットにしたい。


	ikColorMarkSelect2.fx
		2色しか指定できませんが、ikColorMarkSelect.fxより細かく指定できます。
		ikColorMarkSelect.fxでは望ましくない判定が起きる場合、これを使うことで回避できる場合があります。

		複数のikColorMarkSelect2が必要な場合、複製を作ってパラメータを設定してください。


	full_contrast.fx
		おまけ。
		くっきりした陰影を強制的に作るための改造full.fx。
		これを使用しなくてもikPointColorは使用可能です。

		主にやっていることは、
		・アンビエント成分をなくして影を真っ暗にする。
		・トゥーンによる影を強制的に暗くする。
		・リムライトを当てて、エッジ部分に明るい線が出るようにする。
		の3点です。


	pallet34.png
		パレット
		パレットテクスチャは 64ピクセル x (8パレット x 4パレットセット)で構成されています。

		右端1ピクセルは自動パレット選択用のキーカラーになっています。
		自動パレット選択では、画面上にの画素と右端1ピクセルの色が一番近いパレットが選択されます。
			青い色を紫のグラデに置き換えたい場合は、左側63ピクセルを紫のグラデにし、右端1ピクセルだけを青に設定します。

		※キーカラーとして使用するのは、最上位のパレットセットだけになります。

		アルファを設定することで、元の色を残すことも可能です。



■ パラメータの詳細

□ アクセサリ上から設定できるパラメータ

	X: パレットセットの番号。0〜3が設定可能。
		複数のパレットセットを用意しておくことで、1つのpmm内でパレットを交換できます。


	Y: 水玉パターンのサイズを変える。8〜24程度。
		テスト用に作成した水玉パターンの最大サイズを設定します。
		デフォルトで水玉モードはオフになっています。



□ エフェクトファイル上で直接操作するパラメータ

	ikColorMarkSelect.fx

		DefaultMark		適切なパレットが見つからない場合に選択されるパレット番号

		DistanceLatitude	パレット上のキーカラーと許容誤差。
			黒(0,0,0)と白(1,1,1)の差は 3 (= 768/256.0)。
			青(0,0,1)と紫(1,0,1)の差は 1 (= 256/256.0)

		画素とキーカラーとの差が最も少ないパレットが選択される。


	ikColorMarkSelect.fx
		指定した2パレットと一致するかどうか判定する

		DefaultMark		適切なパレットが見つからない場合に選択されるパレット番号

		TargetMark1		最初に判定するパレット番号
		TargetMark2		次に判定するパレット番号

		DistanceLatitude1	許容誤差
		DistanceLatitude2



■ 使用、再配布に関して

	エフェクトの利用、改造などについては自由に行ってもらってかまいません、連絡も不要です。

	このエフェクトを使用したことによって起きたすべての損害等について、
	作者及び関係者は一切責任を負わないものとします。



■ 更新履歴

	2014/11/24 Ver 0.01		初公開

ikeno
