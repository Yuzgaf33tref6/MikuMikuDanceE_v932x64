
ikRaindrops2

■ 概要

	このドキュメントは、MikuMikuEffect用エフェクト「ikRaindrops2」の使い方を説明するものです。
	ikRaindrops2は、窓についた雨粒を表現するためのエフェクトです。
	簡易版よりも表現力があがっていますが、代わりに劣化した部分もあります。(後述)。


■ 使用方法

	MMDのアクセサリに、"ikRaindrops2.x"を追加してください。

	雨粒をつけたい窓付近にアクセサリを配置してください。
	アクセサリの"影"にチェックをつけることで、雨粒のつく範囲が青い半透明のパネルとして可視化されます。
	(アクセサリの"影"をon/offすると、雨の状態がリセットされます。)

	アクセサリのTrで雨の量をコントロールできます。
	0で無し、1で100%になります。ただし、0にしても即座に雨粒が消えません。

	透明エフェクトであること。環境マップをレンダリングしていることから、アクセサリの表示順番によって、見た目がおかしくなる可能性があります。
		水滴に写り込む必要のないモデルを、MMEのRefractRTタブから除外することで、見た目がよくなる場合があります。
		相性の悪いエフェクトから、ikRaindrops.xを除外することで、見た目が改善される場合があります。


■ エフェクトファイル内で設定できる項目

	ParticleSize
		水滴の大きさ。アクセサリのSiを弄っても雨粒の大きさは変わりません。

	LifetimeMin
		水滴が落下するまでの最小時間(秒)
	LifetimeFluctuation
		水滴が落下するまでの揺れ幅(秒)

		出現から、LifetimeMin 〜 LifetimeMin + LifetimeFluctuation の間に雨粒は落下します。

	DropSpeedRate
		水滴の落下速度

	NumRaindropInTextureW
	NumRaindropInTextureH
		テクスチャ上に何個の雨粒パターンがあるか? 自分で雨粒パターンを弄りたい人向け。

	STOP_IN_EDITMODE
		編集モードで雨を止めるかどうか。

	RESET_AT_START
		0フレーム再生時に雨をクリアするかどうか。

	BUFFER_SIZE
		ワーク用テクスチャの大きさ。これを2048や4096などと大きくすることで、水滴の見た目が改善する場合があります。その分、グラフィックカードのメモリを消費します。

		(紹介動画では2048に設定していました。)


■ 簡易版から改善された点。制限。

	・[簡易版] 雨が重なると見た目が不自然になります。
		→ [通常版] 高さが重なるようになりました。表面張力や重力による水滴の変形には対応していません。

	・[簡易版] 通常、雨粒が重なると融合しますが、お互いに干渉することはありません。
		→ [通常版] 雨粒が自分より下にある場合、引きづられるように落下します。
			重なっているように見えるのに無視される。見た目上、重なっていないのに影響を受ける場合があります。

	・[簡易版] 雨粒の流れる跡が直線状になっています。
		→ [通常版] 蛇行するようにしました。雨粒は線ではなく点で描画しているため、高速に落下させると、点線状に見える場合があります。

	・[簡易版/通常版] 窓ガラスの内側から外を見た場合しか表現できません。

	・[通常版] 簡易版の雨粒パーティクルを一度ワーク用のテクスチャに描画しているため、1粒あたりの解像度が下がっています。


■ 雨粒テクスチャについての注意

	白黒で、水滴の高さを表現しています。黒＝水なし。白＝水がある。


■ 使用、再配布に関して

	エフェクトの利用、改造、再配布などについては自由に行ってもらってかまいません、連絡も不要です。

	このエフェクトを使用したことによって起きたすべての損害等について、作者及び関係者は一切責任を負わないものとします。


■ 更新履歴

	2014/10/20 Ver.0.02		レンダリングターゲットの参照に機種依存性があるらしいので修正した。
							水滴再生成の条件を修正。
							水滴落下時間をフレームレート非依存とした。
							水滴の色を変更できるようにした。

	2014/09/26 Ver.0.01		初公開

ikeno
