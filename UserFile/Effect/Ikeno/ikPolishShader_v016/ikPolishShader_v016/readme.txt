
ikPolishShader

--------------------------------------------------------------------------------
■ 概要

ikPolishShaderはPBR(物理ベースレンダリング)風のシェーダーです。
素材特性をあらわすパラメータを元に、周囲の物体を映りこませることで
立体感と素材感を出すことができます。

このドキュメントでは最低限の使い方だけを説明しています。
必要に応じて、readme_detail.txtをお読みください。

以下のURLで使い方を簡単に説明しています。
　 http://www.nicovideo.jp/watch/sm27733338


--------------------------------------------------------------------------------
■ 目次
・使用方法
・v.0.15以前からの移行時の注意
・使用、再配布に関して
・更新履歴


--------------------------------------------------------------------------------
■ 使用方法

□ 最低限必要な設定

0. モデルを読み込む。
　※ できるだけスカイドームや背景モデルを読み込んでください。

1. MMDに ikPolishShader.x を追加する。

2. MMEのエフェクト割り当てを開き、
2-1. Mainタブで、モデルやステージなどに Main/PolishMain.fx を割り当てる。
　※ スカイドームは通常のままにしたほうがよいです。

2-2. EnvMapタブで、スカイドームに対して TEnvMap_emissive.fxを割り当てる。


--------------------------------------------------------------------------------
■ v.0.15以前からの移行時の注意
※ 本項は、v.0.15以前で設定したプロジェクトを使わない場合、
設定ファイルを流用しない場合は、読む必要はありません。


・環境マップ作成位置を自動的に15MMD単位、上方向に持ち上げるようにしました。
ikPolishShader.xの高さを引き上げていた場合は適宜、下げてください。

・マテリアルの設定ファイルを古いバージョンから移行する場合は、
MaterialMap_common.fxsub だけを最新のものに置き換えれば、
基本的にはそのまま利用できます。

・PolishMain.fx も内部を書き換えています。
基本的には、新しい PolishMain_common.fxsubを上書きしないようにして、
旧PolishMain_xxx.fx を 新しいMainフォルダにコピーすることで流用できると思われます。

・SSGIMapRTタブはSSDOMapRTに名前を変えました。中身は同じです。

・ENABLE_HARD_SHADOW は廃止しました。
代わりにコントローラに"シャドウ"を追加しました。
ikPolishShader.fxsub 内の DefaultShadowScale でコントーラが無い場合の値を設定できます。
0でエッジがはっきりとした影、1でボケた影になります。

・環境マップに関する設定を簡略化しました。


--------------------------------------------------------------------------------
■ トラブルシューティング → readme_detail.txtに移行しました。

--------------------------------------------------------------------------------
■ 使用、再配布に関して

エフェクトの利用、改造、再配布などについては自由に行ってもらってかまいません、
連絡も不要です。
このエフェクトを使用したことによって起きたすべての損害等について、
作者及び関係者は一切責任を負わないものとします。


--------------------------------------------------------------------------------
■ 更新履歴

　2016/11/14 v.0.16
　　・コードの整理。不要な処理を削減。
　　・ALによる発光の反射を実装(テスト)。
　　・肌表現の計算式を改善
　　・コントローラで影のボカし幅を調整できるようにした。
　　　それに伴い、ENABLE_HARD_SHADOW は廃止。
　　・環境マップの改善

　2016/09/10 v.0.15
　　・精度を落とした高速モードを追加。
　　・品質レベルを一括で指定できるようにした。
　　・シャドウマップの距離減衰をMaterialで設定するように変更。
　　　これに伴い、MaterialMap_common.fxsub は更新する必要がある。
　　　MaterialMap.fxは引き続き従来のものを流用可能。

　2016/08/27 v.0.14
　　・映り込み、肌表現の計算方式を変更。他調整。

　2016/06/26 v.0.13
　　・太陽光の反射をサポート
　　　 → ikPolishShader.fxsub内のRSMCountを0で無効。
　　・シャドウマップの影をボカさないモードをつけた。(デフォルト無効)
　　　 → ikPolishShader.fxsub内のENABLE_HARD_SHADOWを1で有効。
　　・環境マップを八面体にした
　　　 → ikPolishShader.fxsub内のUSE_OCTAHEDRONを0で従来通り。
　　・各種処理の見直し。
　　(・Matreials関連は Ver0.09以降から互換性があります)

　2016/04/26 v.0.12
　　・映り込みのノイズを軽減

　2016/04/20 v.0.11
　　・スフィアマップも法線マップの影響を受けるようにした。
　　・SSAOの精度を上げるオプションを追加。
　　・環境マップの生成に失敗することがあった不具合を修正
　　・環境マップからデフォルトでキャラを除外

　2016/01/06 v.0.10a
　　・ライト色が正しくなかった不具合を修正

　2015/12/28 v.0.10
　　・Metalnessの扱いを修正
　　・映り込みの修正

　2015/12/05 v.0.09
　　・補助ライト対応
　　・顔用に髪の毛の影が落ちないシャドウマップ設定を追加
　　・肌の透明感表現を追加
　　・簡易環境マップを削除
　　・SSGIの処理をSSDOに変更
　　・その他、細かい調整。

　2015/08/16 v.0.08
　　・映り込みの精度を上げた。
　　・SSAOの計算を修正。
　　・シャドウマップの描画を高速にした。
　　・その他、細かい調整。

　2015/05/12 v.0.07
　　・GI風の新しい映り込み機能を追加
　　・SSAO、その他の修正
　　・最適化。

　2015/04/29 v.0.06
　　・アンチエイリアス機能の追加。
　　・映り込み計算の調整

　2015/03/31 v.0.05
　　・SSSを材質指定可能にした。
　　　材質マップのアルファチャンネルでSSS度を指定可能にした。
　　　Mainのエフェクトで、肌用の色味設定をできるようにした。
　　・ExcellentShadowの統合。
　　・上記にともないいくつかの処理を整理。

　2015/03/18 パッチ
　　・材質マップを要素毎に指定できるようにした。

　2015/03/11 v.0.04
　　・環境マップの作成方法見直し
　　　ikPolishShader.fx内のUSE_SIMPLE_ENVMAPをコメントアウトすることで使用可能です。
　　・映り込み計算の簡略化
　　・肌の計算方法の簡略化

　2015/02/28 v.0.03
　　・コントローラ対応。全体の明るさを調整する機能を追加。
　　　これに伴いライト強度に関連したパラメータを削除。
　　・自己発光色(環境色)の扱いを変更した。
　　　PMXeで環境色となっている項は、MMD上は自己発光色として扱われる。
　　　ライトなど本当に光る素材以外は、暗闇で明るくなり過ぎるため、
　　　デフォルトでは自己発光色を環境色として扱うように変更した。
　　・映り込みの計算で一部ミスがあったのを修正。その他各種計算の見直し。
　　・NCHLモード時に、スペキュラカラーを無視するようにした。
　　　NCHL対応モデルではスペキュラカラーに各種材質設定を格納するため。
　　・環境マップ作成時にスフィアマップを無視できるようにした。

　2015/02/22 v.0.02
　　・静的環境マップに対応。
　　・色計算を微調整。
　　・複数材質の一括指定対応。
　　・readmeを修正。

　2015/02/20 v.0.01
　　・初公開


ikeno
Twitter: @ikeno_mmd
