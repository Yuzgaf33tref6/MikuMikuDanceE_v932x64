
モーションブラーエフェクト：技術解説


■他方式モーションブラーとの比較

・MVTools
　フレーム前後比較による2.5Dブラー。
　速度が上手く検出されれば当エフェクトより綺麗。
　背景の巻き込み、速度の誤検知、フレームずれ、シーン切り替え時の動作などの
問題があり、それらは当エフェクトでは解消されていいる。

・フレームブレンド
　AviUtlのモーションブラー、EasyMotionBlurエフェクトなどが相当。
　前のフレームを単純に合成してブラーとする。動作が速い。
　中間補間はされないため、なめらかなブラーを得るには高fps出力しなければならない。
　高速で動く物体は分裂して見え、液晶の残像みたいで見栄えが悪い。

・商用3Dソフトのモーションブラー機能
　非常に正確に表現され、最も品質が高い。
　同時に、極めて遅い。そもそもMMDでは使えない。


■各エフェクトファイル解説


・VelocityMap.fx

アクセサリの場合、変形がないことを利用し、
ワールドビュー射影行列の記録を取ってベロシティマップを描画します。

深度も同時に出力しています。


PMDの場合、頂点座標バッファを作成して前回の頂点を記録しておき、
ワールドビュー射影行列の記録と組み合わせてベロシティマップを描画します。

頂点のスクリーン座標の記録のみでやろうとすると、
画面をはみ出すような大きなポリゴンが上手くいきませんでした

頂点座標バッファの作成法としては、各頂点をインデックスに対応する位置に移動させたのち
元座標を色として与え、点描を行っています。


・MotionBlur.fx

このへんを参考に
http://journal.mycom.co.jp/column/graphics/036/index.html
2.5Dブラーとラインブラーの組み合わせ

　・2.5Dブラー
　基本的にベロシティマップに従っての1次元の方向性ぼかしをかけているだけですが、
　SvDOFと同様の方法で前後関係を配慮するようになっています。

　・ラインブラー
　ジオメトリシェーダは使えないので、ダミーアクセサリに16,384個の矩形ポリゴンを仕込んで
　ライン生成に代えています。
　LINEBLUR_QUADスイッチをオンにすると画面を縦に4分割して4回に分けて描画し、解像度を稼いでいます。
　それでもやはり解像度が荒いため、2.5Dブラーが優先されるよう仕掛けを施してあります。


・VelocityMapTest.fx
ベロシティマップの動作チェック用のエフェクトです

